pkgname=alfis
pkgver=$(sh ./semver/version.sh --bare)
pkgrel=1
pkgdesc="Alternative Free Identity System"
arch=('x86_64' 'aarch64')
license=('AGPL3')
url='https://github.com/Revertron/Alfis'
depends=('webkit2gtk' 'gtk3')
makedepends=('cargo' 'rust' 'atk' 'pango')
backup=("etc/$pkgname.conf")

build() {
	cd "$startdir/.."

	cargo build --release --all-features --target-dir=target
}

package() {
	cd "$startdir/.."

	install -Dm 755 "target/release/$pkgname" "$pkgdir/usr/bin/$pkgname"

	install -Dm 644 "contrib/systemd/$pkgname.service"  "$pkgdir/usr/lib/systemd/system/$pkgname.service"
	install -Dm 644 "contrib/systemd/$pkgname.sysusers" "$pkgdir/usr/lib/sysusers.d/$pkgname.conf"
	install -Dm 644 "contrib/systemd/$pkgname.tmpfiles" "$pkgdir/usr/lib/tmpfiles.d/$pkgname.conf"
}
